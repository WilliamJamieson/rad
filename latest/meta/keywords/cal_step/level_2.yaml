%YAML 1.1
---
$schema: asdf://stsci.edu/datamodels/roman/schemas/rad_schema-1.0.0
id: asdf://stsci.edu/datamodels/roman/schemas/meta/keywords/cal_step/level_2-1.0.0

title: Level 2 Calibration Status

allOf:
  - $ref: asdf://stsci.edu/datamodels/roman/schemas/meta/keywords/cal_step/shared-1.0.0

  - type: object
    properties:
      assign_wcs:
        title: Assign World Coordinate System (WCS) Step
        description: |
          Step in romancal that assigns a World Coordinate
          System (WCS) object to a science image.
        allOf:
          - $ref: asdf://stsci.edu/datamodels/roman/schemas/meta/helper/cal_step_flag-1.0.0
        archive_catalog:
          datatype: nvarchar(15)
          destination: [ScienceRefData.s_assign_wcs]
      flat_field:
        title: Flat Field Correction Step
        description: |
          Step in romancal in which a science image is
          flat-fielded, whereby each detector pixel is calibrated to give
          the same signal for the same illumination based on the pixel
          response.
        allOf:
          - $ref: asdf://stsci.edu/datamodels/roman/schemas/meta/helper/cal_step_flag-1.0.0
        archive_catalog:
          datatype: nvarchar(15)
          destination: [ScienceRefData.s_flat_field]
      dark:
        title: Dark Current Subtraction Step
        description: |
          Step in romancal that performs a correction for the
          dark current by subtracting the dark reference data from the
          science data.
        allOf:
          - $ref: asdf://stsci.edu/datamodels/roman/schemas/meta/helper/cal_step_flag-1.0.0
        archive_catalog:
          datatype: nvarchar(15)
          destination: [ScienceRefData.s_dark]
      dq_init:
        title: Data Quality Initialization Step
        description: |
          Step in romancal that initializes the data quality
          array and masks known bad pixels.
        allOf:
          - $ref: asdf://stsci.edu/datamodels/roman/schemas/meta/helper/cal_step_flag-1.0.0
        archive_catalog:
          datatype: nvarchar(15)
          destination: [ScienceRefData.s_dq_init]
      linearity:
        title: Classical Linearity Correction Step
        description: |
          Step in romancal that linearizes the ramp data to
          correct for deviations from a linear response.
        allOf:
          - $ref: asdf://stsci.edu/datamodels/roman/schemas/meta/helper/cal_step_flag-1.0.0
        archive_catalog:
          datatype: nvarchar(15)
          destination: [ScienceRefData.s_linearity]
      photom:
        title: Populate Photometric Keywords Step
        description: |
          Step in romancal that populates photometric
          calibration information in the metadata of the science file.
        allOf:
          - $ref: asdf://stsci.edu/datamodels/roman/schemas/meta/helper/cal_step_flag-1.0.0
        archive_catalog:
          datatype: nvarchar(15)
          destination: [ScienceRefData.s_photom]
      source_catalog:
        title: Source Catalog Step
        description: |
          Step in romancal that detects point sources in an
          image for use in astrometric alignment.
        allOf:
          - $ref: asdf://stsci.edu/datamodels/roman/schemas/meta/helper/cal_step_flag-1.0.0
        archive_catalog:
          datatype: nvarchar(15)
          destination: [ScienceRefData.s_source_catalog]
      ramp_fit:
        title: Ramp Fitting Step
        description: |
          Step in romancal that fits a slope to each pixel to
          compute the count rate.
        allOf:
          - $ref: asdf://stsci.edu/datamodels/roman/schemas/meta/helper/cal_step_flag-1.0.0
        archive_catalog:
          datatype: nvarchar(15)
          destination: [ScienceRefData.s_ramp_fit]
      refpix:
        title: Reference Pixel Correction Step
        description: |
          Step in romancal that corrects science pixels for
          additional signal from the readout electronics (e.g., 1/f noise)
          using the reference pixels.
        allOf:
          - $ref: asdf://stsci.edu/datamodels/roman/schemas/meta/helper/cal_step_flag-1.0.0
        archive_catalog:
          datatype: nvarchar(15)
          destination: [ScienceRefData.s_refpix]
      saturation:
        title: Saturation Identification Step
        description: |
          Step in romancal that sets data quality flags for
          pixels at or above the saturation threshold.
        allOf:
          - $ref: asdf://stsci.edu/datamodels/roman/schemas/meta/helper/cal_step_flag-1.0.0
        archive_catalog:
          datatype: nvarchar(15)
          destination: [ScienceRefData.s_saturation]
      tweakreg:
        title: Tweakreg step
        description: |
          Step in romancal that compares the positions of point
          sources in the image with coordinates from an astrometric
          catalog and, if necessary, corrects the World Coordinate System
          (WCS) alignment.
        allOf:
          - $ref: asdf://stsci.edu/datamodels/roman/schemas/meta/helper/cal_step_flag-1.0.0
        archive_catalog:
          datatype: nvarchar(15)
          destination: [ScienceRefData.s_tweakreg]
    required:
      [
        assign_wcs,
        dark,
        dq_init,
        flat_field,
        linearity,
        photom,
        source_catalog,
        ramp_fit,
        refpix,
        saturation,
        tweakreg,
      ]

flowStyle: block
